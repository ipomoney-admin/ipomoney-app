<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPO GMP Live - ipowatch.in</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background: #0b0f1a; color: white; font-family: 'sans-serif'; }
        .glass-card { 
            background: rgba(255, 255, 255, 0.03); 
            backdrop-filter: blur(12px); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            border-radius: 1.25rem;
        }
    </style>
</head>
<body class="bg-[#0b0f1a] min-h-screen p-5 md:p-10">
    <div class="max-w-6xl mx-auto">
        <header class="mb-10 text-center">
            <h1 class="text-4xl font-extrabold text-white mb-2">IPO <span class="text-blue-500">WATCH</span></h1>
            <p class="text-gray-400">Live Grey Market Premium (GMP) Updates</p>
        </header>

        <div id="ipo-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <p class="text-center col-span-full text-gray-500">Loading live data from Supabase...</p>
        </div>
    </div>

    <script>
        const S_URL = "https://blwjuzmvrvtfklthvfoz.supabase.co";
        const S_KEY = "sb_publishable_eJVOHdhBG6Rbbivp8vogLQ_8ADKpsOY";
        const _supabase = supabase.createClient(S_URL, S_KEY);

        async function fetchIPOs() {
            const { data, error } = await _supabase
                .from('ipos')
                .select('*')
                .order('gmp', { ascending: false });

            const container = document.getElementById('ipo-list');
            if (error || !data) {
                container.innerHTML = "<p>Error loading data</p>";
                return;
            }

            container.innerHTML = data.map(ipo => `
                <div class="glass-card p-6 flex flex-col justify-between">
                    <div>
                        <span class="text-[10px] font-bold uppercase tracking-wider px-2 py-1 bg-blue-600/30 text-blue-400 rounded-md">${ipo.type}</span>
                        <h2 class="text-xl font-semibold mt-3 text-white">${ipo.name}</h2>
                    </div>
                    <div class="mt-6 flex justify-between items-end">
                        <div>
                            <p class="text-gray-500 text-xs uppercase font-bold tracking-widest">Live GMP</p>
                            <p class="text-3xl font-black text-green-400 mt-1">â‚¹${ipo.gmp}</p>
                        </div>
                        <div class="h-10 w-10 rounded-full bg-green-500/10 flex items-center justify-center">
                            <div class="h-2 w-2 rounded-full bg-green-500 animate-ping"></div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        fetchIPOs();
    </script>
</body>
</html>
